package Thread;

class Thread1 extends Thread {

    static final Object lock = new Object();   // common lock

    public void run() {
        synchronized (lock) {
            try {
                for (int i = 1; i <= 5; i++) {
                    System.out.println("Thread1: " + i);
                    System.out.println("Thread1 State (inside run): "
                            + Thread.currentThread().getState());

                    Thread.yield();           // RUNNABLE
                    Thread.sleep(2000);       // TIMED_WAITING
                }
            } catch (InterruptedException e) {
                System.out.println("Thread1 interrupted");
            }
            System.out.println("Thread1 finished.");
        }
    }
}

class Thread2 extends Thread {

    static final Object lock = Thread1.lock;   // SAME lock

    public void run() {
        synchronized (lock) {
            try {
                for (int i = 10; i <= 15; i++) {
                    System.out.println("Thread2: " + i);
                    System.out.println("Thread2 State (inside run): "
                            + Thread.currentThread().getState());

                    Thread.yield();           // RUNNABLE
                    Thread.sleep(2000);       // TIMED_WAITING
                }
            } catch (InterruptedException e) {
                System.out.println("Thread2 interrupted");
            }
            System.out.println("Thread2 finished.");
        }
    }
}

public class Main {

    public static void main(String[] args) {

        Thread1 t1 = new Thread1();
        Thread2 t2 = new Thread2();

        // Initial states
        System.out.println("Thread1 Initial State: " + t1.getState()); // NEW
        System.out.println("Thread2 Initial State: " + t2.getState()); // NEW

        // Start both threads
        t1.start();
        t2.start();

        // Show states after start
        System.out.println("Thread1 State after start: " + t1.getState());
        System.out.println("Thread2 State after start: " + t2.getState());

        // Wait for threads to finish
        try {
            System.out.println("Main thread WAITING...");
            t1.join();
            t2.join();
        } catch (InterruptedException e) {
            e.printStackTrace();
        }

        // Final states
        System.out.println("Threads finished");
        System.out.println("Thread1 Final State: " + t1.getState()); // TERMINATED
        System.out.println("Thread2 Final State: " + t2.getState()); // TERMINATED
    }
}
